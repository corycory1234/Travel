import{_ as X,r as o,E as Y,n as tt,b as c,c as n,d as e,i as m,w as f,G as J,H as W,F as w,e as S,q as et,x as E,g as i,f as B,h as _,I as at,A,l as st,p as ot,j as ct,J as nt,K as lt,L as it,O as rt,D as dt,t as j,a as N}from"./index-72d810bb.js";const g=D=>(ot("data-v-1cc3a085"),D=D(),ct(),D),ut={class:"container"},vt={class:"navBar justify-content-center justify-content-md-between py-3"},pt=g(()=>e("div",{class:""},[e("img",{src:nt,alt:""})],-1)),mt={class:"nav-links d-none d-md-flex mt-2"},_t=g(()=>e("img",{src:lt,alt:"",class:"link-img"},null,-1)),ht=g(()=>e("img",{src:it,alt:"",class:"link-img"},null,-1)),ft=g(()=>e("img",{src:rt,alt:"",class:"link-img"},null,-1)),gt={class:"nav justify-content-between shadow-sm d-md-none bg-white w-100 rounded my-1"},wt={class:"nav-item"},kt={class:"nav-item"},yt={class:"nav-item"},xt={class:"input-group mt-2"},St=g(()=>e("option",{value:""},"選擇縣市",-1)),Dt=["value"],Tt=g(()=>e("option",{value:""},"選擇路線",-1)),Bt=["value"],Nt={class:"btn btn-md btnBgc rounded ms-1"},It=["onClick"],bt={class:"container pt-4 g-0"},Ct=g(()=>e("h3",{class:"d-none d-lg-block"},"請先選擇縣市，再選擇公車路線",-1)),Et=["onClick"],jt={class:"pink"},Ut=["onClick"],Rt={class:"pink"},Ot={class:"container"},$t={class:"d-flex justify-content-end"},Vt={class:"pink"},Zt={key:0,class:"container py-5"},Ft={class:"col-8 col-md-2 ps-2"},Jt={class:"row align-items-center justify-content-md-center gx-0"},Wt={class:"col-8 col-md-2 px-2"},At={key:1,class:"container"},zt=dt('<div class="row align-items-center justify-content-md-center gx-0" data-v-1cc3a085><p class="col-4 col-md-2 rounded p-2 text-center noDepart" data-v-1cc3a085>未發車</p><p class="col-8 col-md-2 ps-2" data-v-1cc3a085>西門町</p></div><div class="row align-items-center justify-content-md-center gx-0" data-v-1cc3a085><p class="col-4 col-md-2 rounded p-2 text-center noDepart" data-v-1cc3a085>未發車</p><p class="col-8 col-md-2 ps-2" data-v-1cc3a085>台北車站</p></div><div class="row align-items-center justify-content-md-center gx-0" data-v-1cc3a085><p class="col-4 col-md-2 rounded p-2 text-center onTheWay" data-v-1cc3a085>15分鐘</p><p class="col-8 col-md-2 ps-2" data-v-1cc3a085>捷運忠孝新生站</p></div><div class="row align-items-center justify-content-md-center gx-0" data-v-1cc3a085><p class="col-4 col-md-2 rounded p-2 text-center onTheWay" data-v-1cc3a085>10分鐘</p><p class="col-8 col-md-2 ps-2" data-v-1cc3a085>忠孝SOGO百貨</p></div><div class="row align-items-center justify-content-md-center gx-0" data-v-1cc3a085><p class="col-4 col-md-2 rounded p-2 text-center coming" data-v-1cc3a085>即將到站</p><p class="col-8 col-md-2 ps-2" data-v-1cc3a085>國父紀念館</p></div><div class="row align-items-center justify-content-md-center gx-0" data-v-1cc3a085><p class="col-4 col-md-2 rounded p-2 text-center arriving" data-v-1cc3a085>進站中</p><p class="col-8 col-md-2 ps-2" data-v-1cc3a085>市政府</p></div><div class="row align-items-center justify-content-md-center gx-0" data-v-1cc3a085><p class="col-4 col-md-2 rounded p-2 text-center onTheWay" data-v-1cc3a085>5分鐘</p><p class="col-8 col-md-2 ps-2" data-v-1cc3a085>台北101</p></div><div class="row align-items-center justify-content-md-center gx-0" data-v-1cc3a085><p class="col-4 col-md-2 rounded p-2 text-center onTheWay" data-v-1cc3a085>10分鐘</p><p class="col-8 col-md-2 ps-2" data-v-1cc3a085>象山</p></div>',8),Ht=[zt],Mt={__name:"BusRoute",setup(D){const v=o(""),k=o(""),U=o([]),z=async()=>{const l={headers:{authorization:"Bearer "+await j.getToken()}},s=`https://tdx.transportdata.tw/api/basic/v2/Bus/Route/City/${v.value}?%24format=JSON`;N.get(s,l).then(t=>{U.value=t.data})},R=o([]),O=o([]),T=o(60),$=o([]),V=async()=>{const l={headers:{authorization:"Bearer "+await j.getToken()}},s=`https://tdx.transportdata.tw/api/basic/v2/Bus/EstimatedTimeOfArrival/City/${v.value}/${k.value}?%24format=JSON`;N.get(s,l).then(d=>{const p=d.data,h=p.filter(u=>!u.Direction),Q=p.filter(u=>u.Direction);h.forEach(u=>{R.value.push({StopUID:u.StopUID,EstimateTime:u.EstimateTime})}),Q.forEach(u=>{O.value.push({StopUID:u.StopUID,EstimateTime:u.EstimateTime})}),H()});const t=`https://tdx.transportdata.tw/api/basic/v2/Bus/Route/City/${v.value}/${k.value}?%24top=30&%24format=JSON`;N.get(t,l).then(d=>{$.value=d.data})},y=o([]),x=o([]),a=o(0),r=o(""),H=async()=>{const l={headers:{authorization:"Bearer "+await j.getToken()}};y.value=[],x.value=[];const s=`https://tdx.transportdata.tw/api/basic/v2/Bus/DisplayStopOfRoute/City/${v.value}/${k.value}?%24format=JSON`;N.get(s,l).then(t=>{const d=t.data;d[0].Stops.forEach(p=>{R.value.forEach(h=>{p.StopUID===h.StopUID&&(a.value=Math.floor(h.EstimateTime/60),a.value===0?r.value="進站中":a.value<=1&&0<a.value?r.value="即將到站":a.value?r.value=`${a.value} 分鐘`:r.value="未發車")}),y.value.push({stops:p.StopName.Zh_tw,timeText:r.value,time:a.value})}),d[1].Stops.forEach(p=>{O.value.forEach(h=>{p.StopUID===h.StopUID&&(a.value=Math.floor(h.EstimateTime/60),a.value===0?r.value="進站中":a.value<=1&&0<a.value?r.value="即將到站":a.value?r.value=`${a.value}分鐘`:r.value="未發車")}),x.value.push({stops:p.StopName.Zh_tw,timeText:r.value,time:a.value})})})},I=o(!0),b=o(!1),M=()=>{b.value=!1,I.value=!0},G=()=>{I.value=!1,b.value=!0};let Z,F;const L=()=>{Z=setInterval(()=>{T.value--,T.value===0&&(T.value=60)},1e3)},q=()=>{F=setInterval(()=>{V()},6e4)},K=()=>{clearInterval(Z),clearInterval(F),L(),q()},P=()=>{V(),K()};return Y(()=>v.value,()=>{v.value&&setTimeout(()=>{z()},1e3)}),(C,l)=>{const s=tt("router-link");return c(),n(w,null,[e("div",ut,[e("nav",vt,[m(s,{to:{name:"Home"}},{default:f(()=>[pt]),_:1}),e("div",mt,[m(s,{to:"/view/Home.vue",class:"header-link spot text-nowrap",href:"#"},{default:f(()=>[_t,_(" 台灣景點 ")]),_:1}),m(s,{to:"/view/FoodTravel.vue",class:"header-link food text-nowrap",href:"#"},{default:f(()=>[ht,_(" 美食住宿 ")]),_:1}),m(s,{to:{name:"BusRoute"},href:"#",class:"header-link traffic text-nowrap"},{default:f(()=>[ft,_(" 景點交通 ")]),_:1})])]),e("ul",gt,[e("li",wt,[m(s,{to:"/view/Home.vue",class:"nav-link p-2 activeTrue","aria-current":"page",href:"#"},{default:f(()=>[_("景點活動 ")]),_:1})]),e("li",kt,[m(s,{to:"/view/FoodTravel.vue",class:"nav-link p-2 activeTrue",href:"#"},{default:f(()=>[_("美食住宿 ")]),_:1})]),e("li",yt,[m(s,{to:"/view/BusRoute/BusRoute.vue",class:"nav-link p-2 activeTrue",href:"#"},{default:f(()=>[_("景點交通 ")]),_:1})])]),e("div",xt,[J(e("select",{name:"",id:"",class:"form-select me-1 rounded border-0 shadow-sm","onUpdate:modelValue":l[0]||(l[0]=t=>v.value=t)},[St,(c(!0),n(w,null,S(et(at),(t,d)=>(c(),n("option",{value:t.Value,key:d},i(t.CityName),9,Dt))),128))],512),[[W,v.value]]),J(e("select",{name:"",id:"",class:"form-select rounded border-0 shadow-sm","onUpdate:modelValue":l[1]||(l[1]=t=>k.value=t)},[Tt,(c(!0),n(w,null,S(U.value,t=>(c(),n("option",{value:t.RouteName.Zh_tw,key:t.RouteUID}," ["+i(t.RouteName.Zh_tw)+"] "+i(t.DepartureStopNameZh)+" - "+i(t.DestinationStopNameZh),9,Bt))),128))],512),[[W,k.value]]),e("button",Nt,[e("span",null,[e("i",{class:"bi bi-search",onClick:E(P,["prevent"])},null,8,It)])])]),e("div",bt,[Ct,(c(!0),n(w,null,S($.value,t=>(c(),n("ul",{class:"row row-cols-2 mx-1 rounded py-2 shadow-sm",key:t.RouteID},[e("li",{class:"col",onClick:E(M,["prevent"])},[_("往 "),e("span",jt,i(t.DepartureStopNameZh),1)],8,Et),e("li",{class:"col",onClick:E(G,["prevent"])},[_("往 "),e("span",Rt,i(t.DestinationStopNameZh),1)],8,Ut)]))),128))])]),e("div",Ot,[e("div",$t,[e("p",Vt," *每隔"+i(T.value)+"秒自動更新",1)])]),y.value.length>0||x.value.length>0?(c(),n("div",Zt,[I.value?(c(!0),n(w,{key:0},S(y.value,(t,d)=>(c(),n("div",{key:d,class:"row align-items-center justify-content-md-center gx-0"},[e("p",{class:A(["col-4 col-md-2 rounded p-2 text-center",{arriving:t.time===0,coming:t.time<=1&&t.time>0,onTheWay:t.time>1,noDepart:!t.time}])},i(t.timeText),3),e("p",Ft,i(t.stops),1)]))),128)):B("",!0),b.value?(c(!0),n(w,{key:1},S(x.value,t=>(c(),n("div",Jt,[e("p",{class:A(["col-4 col-md-2 rounded p-2 text-center",{arriving:t.time===0,coming:t.time<=1&&t.time>0,onTheWay:t.time>1,noDepart:!t.time}])},i(t.timeText),3),e("p",Wt,i(t.stops),1)]))),256)):B("",!0)])):B("",!0),y.value.length<=0||x.value.length<=0?(c(),n("div",At,Ht)):B("",!0),m(st)],64)}}},Lt=X(Mt,[["__scopeId","data-v-1cc3a085"]]);export{Lt as default};
