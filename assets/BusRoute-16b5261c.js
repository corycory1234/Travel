import{_ as ee,r as o,E as te,x as se,b as i,c as l,d as t,j as v,z as _,n as k,H as J,I as z,F as y,e as D,i as ae,w as F,h as c,f as E,J as oe,g as d,K as ne,G as ie,p as le,k as ce,L as ue,O as A,P as re,Q as ve,t as U,a as C}from"./index-9cee7dff.js";const m=x=>(le("data-v-1e33e00c"),x=x(),ce(),x),de={class:"container"},pe={class:"navBar justify-content-center justify-content-md-between py-3"},_e=m(()=>t("div",{class:""},[t("img",{src:ue,alt:""})],-1)),me={class:"nav-links d-none d-md-flex mt-2"},he=m(()=>t("img",{src:A,alt:"",class:"link-img"},null,-1)),fe=m(()=>t("img",{src:re,alt:"",class:"link-img"},null,-1)),ge=m(()=>t("img",{src:ve,alt:"",class:"link-img"},null,-1)),we=m(()=>t("img",{src:A,alt:"",class:"link-img"},null,-1)),ke={class:"nav justify-content-between shadow-sm d-md-none bg-white w-100 rounded my-1"},ye={class:"nav-item"},Te={class:"nav-item"},Se={class:"nav-item"},De={class:"nav-item"},xe={class:"input-group mt-2"},Be=m(()=>t("option",{value:"",disabled:""},"選擇縣市",-1)),be=["value"],Re=m(()=>t("option",{value:"",disabled:""},"選擇路線",-1)),Ce=["value"],Ie={class:"btn btn-md btnBgc rounded ms-1"},Ne=["onClick"],Fe={class:"container pt-4 g-0"},Ee=m(()=>t("h3",{class:"d-none d-lg-block"},"請先選擇縣市，再選擇公車路線",-1)),Ue=["onClick"],Me={class:"pink"},$e=["onClick"],Oe={class:"pink"},Ze={class:"container"},je={class:"d-flex justify-content-end"},Ve={class:"pink"},He={key:0,class:"container mb-5"},Je={class:"col-8 col-md-2 ps-2"},ze={class:"row align-items-center justify-content-md-center gx-0"},Ae={class:"col-8 col-md-2 px-2"},Ge=m(()=>t("div",{class:"container-fluid text-center bg-white py-3 fixed-bottom"},[t("p",{class:"footer-txt"},"Taiwan Tourguide © Code: Kory / Design: KT")],-1)),Ke={__name:"BusRoute",setup(x){const h=o(""),T=o(""),M=o([]),G=async()=>{const n={headers:{authorization:"Bearer "+await U.getToken()}},s=`https://tdx.transportdata.tw/api/basic/v2/Bus/Route/City/${h.value}?%24format=JSON`;C.get(s,n).then(e=>{M.value=e.data})},$=o([]),O=o([]),B=o(60),Z=o([]),j=async()=>{const n={headers:{authorization:"Bearer "+await U.getToken()}},s=`https://tdx.transportdata.tw/api/basic/v2/Bus/EstimatedTimeOfArrival/City/${h.value}/${T.value}?%24format=JSON`;C.get(s,n).then(r=>{const g=r.data,w=g.filter(p=>!p.Direction),Y=g.filter(p=>p.Direction);w.forEach(p=>{$.value.push({StopUID:p.StopUID,EstimateTime:p.EstimateTime})}),Y.forEach(p=>{O.value.push({StopUID:p.StopUID,EstimateTime:p.EstimateTime})}),K()});const e=`https://tdx.transportdata.tw/api/basic/v2/Bus/Route/City/${h.value}/${T.value}?%24top=30&%24format=JSON`;C.get(e,n).then(r=>{Z.value=r.data})},b=o([]),R=o([]),a=o(0),u=o(""),K=async()=>{const n={headers:{authorization:"Bearer "+await U.getToken()}};b.value=[],R.value=[];const s=`https://tdx.transportdata.tw/api/basic/v2/Bus/DisplayStopOfRoute/City/${h.value}/${T.value}?%24format=JSON`;C.get(s,n).then(e=>{const r=e.data;r[0].Stops.forEach(g=>{$.value.forEach(w=>{g.StopUID===w.StopUID&&(a.value=Math.floor(w.EstimateTime/60),a.value===0?u.value="進站中":a.value<=1&&0<a.value?u.value="即將到站":a.value?u.value=`${a.value} 分鐘`:u.value="未發車")}),b.value.push({stops:g.StopName.Zh_tw,timeText:u.value,time:a.value})}),r[1].Stops.forEach(g=>{O.value.forEach(w=>{g.StopUID===w.StopUID&&(a.value=Math.floor(w.EstimateTime/60),a.value===0?u.value="進站中":a.value<=1&&0<a.value?u.value="即將到站":a.value?u.value=`${a.value}分鐘`:u.value="未發車")}),R.value.push({stops:g.StopName.Zh_tw,timeText:u.value,time:a.value})})})},I=o(!0),N=o(!1),L=()=>{N.value=!1,I.value=!0},W=()=>{I.value=!1,N.value=!0};let V,H;const P=()=>{V=setInterval(()=>{B.value--,B.value===0&&(B.value=60)},1e3)},Q=()=>{H=setInterval(()=>{j()},6e4)},q=()=>{clearInterval(V),clearInterval(H),P(),Q()},X=()=>{j(),q()},f=S=>oe().path===S;return te(()=>h.value,()=>{h.value&&setTimeout(()=>{G()},1e3)}),(S,n)=>{const s=se("router-link");return i(),l(y,null,[t("div",de,[t("nav",pe,[v(s,{to:{name:"Home"}},{default:_(()=>[_e]),_:1}),t("div",me,[v(s,{to:"/view/Home.vue",class:"header-link spot text-nowrap",href:"#"},{default:_(()=>[he,d(" 台灣景點 ")]),_:1}),v(s,{to:"/view/FoodTravel.vue",class:"header-link food text-nowrap",href:"#"},{default:_(()=>[fe,d(" 美食住宿 ")]),_:1}),v(s,{to:{name:"BusRoute"},href:"#",class:"header-link traffic text-nowrap"},{default:_(()=>[ge,d(" 景點交通 ")]),_:1}),v(s,{to:{name:"MyFavorite"},class:"header-link spot text-nowrap",href:"#"},{default:_(()=>[we,d(" 我的收藏 ")]),_:1})])]),t("ul",ke,[t("li",ye,[v(s,{to:"/view/Home.vue",class:k(["nav-link p-2",{activeTrue:f("/view/Home.vue"),activeFalse:!f("/view/Home.vue")}]),"aria-current":"page"},{default:_(()=>[d("景點活動 ")]),_:1},8,["class"])]),t("li",Te,[v(s,{to:"/view/FoodTravel.vue",class:k(["nav-link p-2",{activeTrue:f("/view/FoodTravel.vue"),activeFalse:!f("/view/FoodTravel.vue")}])},{default:_(()=>[d("美食住宿 ")]),_:1},8,["class"])]),t("li",Se,[v(s,{to:"/view/BusRoute/BusRoute.vue",class:k(["nav-link p-2",{activeTrue:f("/view/BusRoute/BusRoute.vue"),activeFalse:!f("/view/BusRoute/BusRoute.vue")}])},{default:_(()=>[d("景點交通 ")]),_:1},8,["class"])]),t("li",De,[v(s,{to:{name:"MyFavorite"},class:k(["nav-link p-2",{activeTrue:f("/view/MyFavorite/MyFavorite.vue"),activeFalse:!f("/view/MyFavorite/MyFavorite.vue")}])},{default:_(()=>[d("我的收藏 ")]),_:1},8,["class"])])]),t("div",xe,[J(t("select",{name:"",id:"",class:"form-select me-1 rounded border-0 shadow-sm","onUpdate:modelValue":n[0]||(n[0]=e=>h.value=e)},[Be,(i(!0),l(y,null,D(ae(ne),(e,r)=>(i(),l("option",{value:e.Value,key:r},c(e.CityName),9,be))),128))],512),[[z,h.value]]),J(t("select",{name:"",id:"",class:"form-select rounded border-0 shadow-sm","onUpdate:modelValue":n[1]||(n[1]=e=>T.value=e)},[Re,(i(!0),l(y,null,D(M.value,e=>(i(),l("option",{value:e.RouteName.Zh_tw,key:e.RouteUID}," ["+c(e.RouteName.Zh_tw)+"] "+c(e.DepartureStopNameZh)+" - "+c(e.DestinationStopNameZh),9,Ce))),128))],512),[[z,T.value]]),t("button",Ie,[t("span",null,[t("i",{class:"bi bi-search",onClick:F(X,["prevent"])},null,8,Ne)])])]),t("div",Fe,[Ee,(i(!0),l(y,null,D(Z.value,e=>(i(),l("ul",{class:"row row-cols-2 mx-1 rounded py-2 shadow-sm",key:e.RouteID},[t("li",{class:"col",onClick:F(L,["prevent"])},[d("往 "),t("span",Me,c(e.DepartureStopNameZh),1)],8,Ue),t("li",{class:"col",onClick:F(W,["prevent"])},[d("往 "),t("span",Oe,c(e.DestinationStopNameZh),1)],8,$e)]))),128))])]),t("div",Ze,[t("div",je,[t("p",Ve," *每隔"+c(B.value)+"秒自動更新",1)])]),b.value.length>0||R.value.length>0?(i(),l("div",He,[I.value?(i(!0),l(y,{key:0},D(b.value,(e,r)=>(i(),l("div",{key:r,class:"row align-items-center justify-content-md-center gx-0"},[t("p",{class:k(["col-4 col-md-2 rounded p-2 text-center",{arriving:e.time===0,coming:e.time<=1&&e.time>0,onTheWay:e.time>1,noDepart:!e.time}])},c(e.timeText),3),t("p",Je,c(e.stops),1)]))),128)):E("",!0),N.value?(i(!0),l(y,{key:1},D(R.value,e=>(i(),l("div",ze,[t("p",{class:k(["col-4 col-md-2 rounded p-2 text-center",{arriving:e.time===0,coming:e.time<=1&&e.time>0,onTheWay:e.time>1,noDepart:!e.time}])},c(e.timeText),3),t("p",Ae,c(e.stops),1)]))),256)):E("",!0)])):E("",!0),v(ie),Ge],64)}}},We=ee(Ke,[["__scopeId","data-v-1e33e00c"]]);export{We as default};
