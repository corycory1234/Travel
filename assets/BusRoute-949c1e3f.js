import{_ as Y,r as o,E as ee,n as te,b as c,c as n,d as t,i as m,w as f,A as D,G as J,H as W,F as k,e as B,q as ae,x as j,g as i,f as I,I as se,h as _,J as oe,l as ce,p as ne,j as le,K as ie,L as re,O as de,P as ue,D as ve,t as U,a as b}from"./index-14f10ae1.js";const g=R=>(ne("data-v-7a48c38a"),R=R(),le(),R),pe={class:"container"},me={class:"navBar justify-content-center justify-content-md-between py-3"},_e=g(()=>t("div",{class:""},[t("img",{src:ie,alt:""})],-1)),he={class:"nav-links d-none d-md-flex mt-2"},fe=g(()=>t("img",{src:re,alt:"",class:"link-img"},null,-1)),ge=g(()=>t("img",{src:de,alt:"",class:"link-img"},null,-1)),we=g(()=>t("img",{src:ue,alt:"",class:"link-img"},null,-1)),ke={class:"nav justify-content-between shadow-sm d-md-none bg-white w-100 rounded my-1"},ye={class:"nav-item"},xe={class:"nav-item"},Se={class:"nav-item"},Te={class:"input-group mt-2"},De=g(()=>t("option",{value:""},"選擇縣市",-1)),Be=["value"],Re=g(()=>t("option",{value:""},"選擇路線",-1)),Ne=["value"],Ie={class:"btn btn-md btnBgc rounded ms-1"},be=["onClick"],Ce={class:"container pt-4 g-0"},Ee=g(()=>t("h3",{class:"d-none d-lg-block"},"請先選擇縣市，再選擇公車路線",-1)),je=["onClick"],Ue={class:"pink"},Fe=["onClick"],Oe={class:"pink"},$e={class:"container"},Ve={class:"d-flex justify-content-end"},Ze={class:"pink"},Ae={key:0,class:"container py-5"},He={class:"col-8 col-md-2 ps-2"},Je={class:"row align-items-center justify-content-md-center gx-0"},We={class:"col-8 col-md-2 px-2"},ze={key:1,class:"container"},Me=ve('<div class="row align-items-center justify-content-md-center gx-0" data-v-7a48c38a><p class="col-4 col-md-2 rounded p-2 text-center noDepart" data-v-7a48c38a>未發車</p><p class="col-8 col-md-2 ps-2" data-v-7a48c38a>西門町</p></div><div class="row align-items-center justify-content-md-center gx-0" data-v-7a48c38a><p class="col-4 col-md-2 rounded p-2 text-center noDepart" data-v-7a48c38a>未發車</p><p class="col-8 col-md-2 ps-2" data-v-7a48c38a>台北車站</p></div><div class="row align-items-center justify-content-md-center gx-0" data-v-7a48c38a><p class="col-4 col-md-2 rounded p-2 text-center onTheWay" data-v-7a48c38a>15分鐘</p><p class="col-8 col-md-2 ps-2" data-v-7a48c38a>捷運忠孝新生站</p></div><div class="row align-items-center justify-content-md-center gx-0" data-v-7a48c38a><p class="col-4 col-md-2 rounded p-2 text-center onTheWay" data-v-7a48c38a>10分鐘</p><p class="col-8 col-md-2 ps-2" data-v-7a48c38a>忠孝SOGO百貨</p></div><div class="row align-items-center justify-content-md-center gx-0" data-v-7a48c38a><p class="col-4 col-md-2 rounded p-2 text-center coming" data-v-7a48c38a>即將到站</p><p class="col-8 col-md-2 ps-2" data-v-7a48c38a>國父紀念館</p></div><div class="row align-items-center justify-content-md-center gx-0" data-v-7a48c38a><p class="col-4 col-md-2 rounded p-2 text-center arriving" data-v-7a48c38a>進站中</p><p class="col-8 col-md-2 ps-2" data-v-7a48c38a>市政府</p></div><div class="row align-items-center justify-content-md-center gx-0" data-v-7a48c38a><p class="col-4 col-md-2 rounded p-2 text-center onTheWay" data-v-7a48c38a>5分鐘</p><p class="col-8 col-md-2 ps-2" data-v-7a48c38a>台北101</p></div><div class="row align-items-center justify-content-md-center gx-0" data-v-7a48c38a><p class="col-4 col-md-2 rounded p-2 text-center onTheWay" data-v-7a48c38a>10分鐘</p><p class="col-8 col-md-2 ps-2" data-v-7a48c38a>象山</p></div>',8),Ge=[Me],Le={__name:"BusRoute",setup(R){const v=o(""),y=o(""),F=o([]),z=async()=>{const l={headers:{authorization:"Bearer "+await U.getToken()}},s=`https://tdx.transportdata.tw/api/basic/v2/Bus/Route/City/${v.value}?%24format=JSON`;b.get(s,l).then(e=>{F.value=e.data})},O=o([]),$=o([]),N=o(60),V=o([]),Z=async()=>{const l={headers:{authorization:"Bearer "+await U.getToken()}},s=`https://tdx.transportdata.tw/api/basic/v2/Bus/EstimatedTimeOfArrival/City/${v.value}/${y.value}?%24format=JSON`;b.get(s,l).then(d=>{const p=d.data,h=p.filter(u=>!u.Direction),X=p.filter(u=>u.Direction);h.forEach(u=>{O.value.push({StopUID:u.StopUID,EstimateTime:u.EstimateTime})}),X.forEach(u=>{$.value.push({StopUID:u.StopUID,EstimateTime:u.EstimateTime})}),M()});const e=`https://tdx.transportdata.tw/api/basic/v2/Bus/Route/City/${v.value}/${y.value}?%24top=30&%24format=JSON`;b.get(e,l).then(d=>{V.value=d.data})},x=o([]),S=o([]),a=o(0),r=o(""),M=async()=>{const l={headers:{authorization:"Bearer "+await U.getToken()}};x.value=[],S.value=[];const s=`https://tdx.transportdata.tw/api/basic/v2/Bus/DisplayStopOfRoute/City/${v.value}/${y.value}?%24format=JSON`;b.get(s,l).then(e=>{const d=e.data;d[0].Stops.forEach(p=>{O.value.forEach(h=>{p.StopUID===h.StopUID&&(a.value=Math.floor(h.EstimateTime/60),a.value===0?r.value="進站中":a.value<=1&&0<a.value?r.value="即將到站":a.value?r.value=`${a.value} 分鐘`:r.value="未發車")}),x.value.push({stops:p.StopName.Zh_tw,timeText:r.value,time:a.value})}),d[1].Stops.forEach(p=>{$.value.forEach(h=>{p.StopUID===h.StopUID&&(a.value=Math.floor(h.EstimateTime/60),a.value===0?r.value="進站中":a.value<=1&&0<a.value?r.value="即將到站":a.value?r.value=`${a.value}分鐘`:r.value="未發車")}),S.value.push({stops:p.StopName.Zh_tw,timeText:r.value,time:a.value})})})},C=o(!0),E=o(!1),G=()=>{E.value=!1,C.value=!0},L=()=>{C.value=!1,E.value=!0};let A,H;const q=()=>{A=setInterval(()=>{N.value--,N.value===0&&(N.value=60)},1e3)},K=()=>{H=setInterval(()=>{Z()},6e4)},P=()=>{clearInterval(A),clearInterval(H),q(),K()},Q=()=>{Z(),P()},w=T=>se().path===T;return ee(()=>v.value,()=>{v.value&&setTimeout(()=>{z()},1e3)}),(T,l)=>{const s=te("router-link");return c(),n(k,null,[t("div",pe,[t("nav",me,[m(s,{to:{name:"Home"}},{default:f(()=>[_e]),_:1}),t("div",he,[m(s,{to:"/view/Home.vue",class:"header-link spot text-nowrap",href:"#"},{default:f(()=>[fe,_(" 台灣景點 ")]),_:1}),m(s,{to:"/view/FoodTravel.vue",class:"header-link food text-nowrap",href:"#"},{default:f(()=>[ge,_(" 美食住宿 ")]),_:1}),m(s,{to:{name:"BusRoute"},href:"#",class:"header-link traffic text-nowrap"},{default:f(()=>[we,_(" 景點交通 ")]),_:1})])]),t("ul",ke,[t("li",ye,[m(s,{to:"/view/Home.vue",class:D(["nav-link p-2",{activeTrue:w("/view/Home.vue"),activeFalse:!w("/view/Home.vue")}]),"aria-current":"page"},{default:f(()=>[_("景點活動 ")]),_:1},8,["class"])]),t("li",xe,[m(s,{to:"/view/FoodTravel.vue",class:D(["nav-link p-2",{activeTrue:w("/view/FoodTravel.vue"),activeFalse:!w("/view/FoodTravel.vue")}])},{default:f(()=>[_("美食住宿 ")]),_:1},8,["class"])]),t("li",Se,[m(s,{to:"/view/BusRoute/BusRoute.vue",class:D(["nav-link p-2",{activeTrue:w("/view/BusRoute/BusRoute.vue"),activeFalse:!w("/view/BusRoute/BusRoute.vue")}])},{default:f(()=>[_("景點交通 ")]),_:1},8,["class"])])]),t("div",Te,[J(t("select",{name:"",id:"",class:"form-select me-1 rounded border-0 shadow-sm","onUpdate:modelValue":l[0]||(l[0]=e=>v.value=e)},[De,(c(!0),n(k,null,B(ae(oe),(e,d)=>(c(),n("option",{value:e.Value,key:d},i(e.CityName),9,Be))),128))],512),[[W,v.value]]),J(t("select",{name:"",id:"",class:"form-select rounded border-0 shadow-sm","onUpdate:modelValue":l[1]||(l[1]=e=>y.value=e)},[Re,(c(!0),n(k,null,B(F.value,e=>(c(),n("option",{value:e.RouteName.Zh_tw,key:e.RouteUID}," ["+i(e.RouteName.Zh_tw)+"] "+i(e.DepartureStopNameZh)+" - "+i(e.DestinationStopNameZh),9,Ne))),128))],512),[[W,y.value]]),t("button",Ie,[t("span",null,[t("i",{class:"bi bi-search",onClick:j(Q,["prevent"])},null,8,be)])])]),t("div",Ce,[Ee,(c(!0),n(k,null,B(V.value,e=>(c(),n("ul",{class:"row row-cols-2 mx-1 rounded py-2 shadow-sm",key:e.RouteID},[t("li",{class:"col",onClick:j(G,["prevent"])},[_("往 "),t("span",Ue,i(e.DepartureStopNameZh),1)],8,je),t("li",{class:"col",onClick:j(L,["prevent"])},[_("往 "),t("span",Oe,i(e.DestinationStopNameZh),1)],8,Fe)]))),128))])]),t("div",$e,[t("div",Ve,[t("p",Ze," *每隔"+i(N.value)+"秒自動更新",1)])]),x.value.length>0||S.value.length>0?(c(),n("div",Ae,[C.value?(c(!0),n(k,{key:0},B(x.value,(e,d)=>(c(),n("div",{key:d,class:"row align-items-center justify-content-md-center gx-0"},[t("p",{class:D(["col-4 col-md-2 rounded p-2 text-center",{arriving:e.time===0,coming:e.time<=1&&e.time>0,onTheWay:e.time>1,noDepart:!e.time}])},i(e.timeText),3),t("p",He,i(e.stops),1)]))),128)):I("",!0),E.value?(c(!0),n(k,{key:1},B(S.value,e=>(c(),n("div",Je,[t("p",{class:D(["col-4 col-md-2 rounded p-2 text-center",{arriving:e.time===0,coming:e.time<=1&&e.time>0,onTheWay:e.time>1,noDepart:!e.time}])},i(e.timeText),3),t("p",We,i(e.stops),1)]))),256)):I("",!0)])):I("",!0),x.value.length<=0||S.value.length<=0?(c(),n("div",ze,Ge)):I("",!0),m(ce)],64)}}},Ke=Y(Le,[["__scopeId","data-v-7a48c38a"]]);export{Ke as default};
